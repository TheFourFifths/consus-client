language: node_js

node_js:
  - '6'
  - '4'

cache:
  directories:
    - node_modules

install:
  - npm install

script:
  - npm test

after_success:
  - npm run coverage
  - bash <(curl -s https://codecov.io/bash)

notifications:
  email: false
  slack:
    rooms:
      - secure: NGn87q+6FfLVKwuC0j0IbqT5uJgZUTEiSZwSMzZnVpnI0f27sT4cRQDEJpfKge9GJoMyPUNR8rfYJVX5zSLEV+jXV6sCxnQO3PDNSPJyvBjQuuiNF/ZNItEc+TEg3QCiv2s9PjcVQfc2r7F6+tVG5Ce+vfTpsgRZplfAG3PAYtSePHUTbWhDvARq5eTMW++P1oqaxhL0KxGuQMKBqjU2S+LAt1ky7UdhZqu6+6LY1oaaTDjl8Yvn/GdRklD39aWW6vx2Z2kvuFW2Stq9vtQ0GFZdt8ttTbn2l8nwAuOluIFvseooTtClDfcVDutQD42TD5/pRGjSHSaNmGbMCEcMKxQ55e4gY5KUkWdEMXIq0u9gr5xQa63pq/tQoSni/9YOs4jtFLYYU0ZWr6zY6cpqka7q8uxE22P61abLTIlEbSGatNsTgKoX5Upnj2U/L8BKbcWG4YHwXdlG6F7qyMIxTArYd9aja3nTLgXzwhT2f0WgwwB+vDv5LoQHNm2H2VXrS4rwQ5lhD5DGzFvQFl8WS+p7EHLibHN2s+ZiU8k+LvVN88THDlun+G5jVAoJAkg83OVguU284BZC+6kHbxMtjMm3T9lgAAXp+mcWaL0Jopm+JTlRvnT5hKyJVklKtWB0Gn4ox73qsSAc7OrX2P7ZrZ6ztITWNA6LdPquQVYZBYA=
    on_success: change
    on_failure: always

before_deploy: "npm run package"

deploy:
  provider: releases
  api_key:
    secure: "w/RNsuiRF3qyVQ6myUAaVUh3+vCTmYLkFEWN7A+oqcm6sZ2WSYz/G5zJJHriaFjjvj6vtx14Q9mulcwaCcCckvQsHzYv8JL5ioDytaIWxdKqUBTRZ9761o4niATfYtMFq2T/D4eLJa6ul7DOqZCtK5gLJPMkRCrHKpvJjsh9IbKuucIveTq0mD6Lsc3V2BccWxUr6iXRW8/LKQzXDvJ8qNH2OoSTiSSTSYyyk2MD+GlacSUeWlDcJ6uGJfnqJWs1ejFxbJZHkw4+DaGPSstQ6+9fj39414DROA4XZ2cD+sz0gRv5kDKAxWQZhuGa5ZQPhrhhLeym5C5JtUqt7VYnDqs7BiBe6Uib1RLYqvWDe+AZUmS1v8GRfvkmFmQE0RM/yzbCWm/zqQaemk9df05nCv3E2RnZDAy+PiR4IDGqD0Anq4E9aciyZMroQEDJrmMEhWl59lfGMC9s2AU7y47DKttSuJyYfUx4x1jNv8NlmOYF0FKBXOtWMXoUsoG8yCz2V98We1Yr2tnAeh/ZjYYALxbQf/P4kGjTuMYQEKiWj4ePYsp6R/VTM2VTa2aPle0PoC2sLrBKmVaXxALAsBF0Jvrx01zw2bvQ40CkAIJLvXuTonltTQwlCzoCLWqAF9EHgJRAaAjMZHKc71PCB/48i1RkoqrRSQz5rMBtRH/AOWY="
  file:
    - "Consus-Client-linux.zip"
    - "Consus-Client-macos.zip"
    - "Consus-Client-win.zip"
  skip_cleanup: true
  on:
    tags: true
    node: '6'
